
## ‚öôÔ∏è NGINX Configuration for WP Super Cache Exclusions

This configuration file tells **NGINX when to bypass the cache** and when to serve cached files generated by the **WP Super Cache** plugin in WordPress.

---

### üõ†Ô∏è Step 1: Create WP Super Cache Exclusion File

```bash
cd /etc/nginx/includes
sudo nano wp_super_cache_excludes.conf
```

---

### üìÑ Step 2: Paste the Following Content

```nginx
# WP Super Cache NGINX Cache Exclusions Rules.
set $cache_uri $request_uri;

# POST requests and URLs with query strings should bypass cache
if ($request_method = POST) {
	set $cache_uri 'null cache';
}
if ($query_string != "") {
    set $cache_uri 'null cache';
}

# Skip cache for admin, login, sitemaps, feeds, special WP paths
if ($request_uri ~* "(/wp-admin/|/xmlrpc.php|/wp-(app|cron|login|register|mail).php|wp-.*.php|/feed/|index.php|wp-comments-popup.php|wp-links-opml.php|wp-locations.php|sitemap(_index)?.xml|[a-z0-9_-]+-sitemap([0-9]+)?.xml)") {
    set $cache_uri 'null cache';
}

# Skip cache for logged-in users and commenters
if ($http_cookie ~* "comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_logged_in") {
    set $cache_uri 'null cache';
}

# Serve cache if it exists, fallback to PHP
location / {
    try_files /wp-content/cache/supercache/$http_host/$cache_uri/index-https.html $uri $uri/ /index.php?$args;
}
```

---

### üìä Explanation Table: Directive Overview

| **Directive**                  | **Explanation**                                                                                                                                  |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| `set $cache_uri $request_uri;` | Sets default cache key to the current URI.                                                                                                       |
| `if ($request_method = POST)`  | POST requests usually modify data and should bypass the cache.                                                                                   |
| `if ($query_string != "")`     | URLs with query parameters (e.g. search results) should bypass cache.                                                                            |
| `if ($request_uri ~* "...")`   | Avoids caching sensitive or dynamic pages (admin, feeds, login, etc.).                                                                           |
| `if ($http_cookie ~* "...")`   | Skips caching for logged-in users and those who recently commented.                                                                              |
| `location / { try_files ... }` | Tries to serve the cached version of the page if available; otherwise, falls back to normal request handling (static file or PHP via WordPress). |

---

### ‚úÖ Usage Instructions

1. **Include this file** in your site config file:

```nginx
include /etc/nginx/includes/wp_super_cache_excludes.conf;
```

2. Make sure this include is **placed outside** any existing `location` blocks (or replace the `location /` block if present).

3. Reload NGINX:

```bash
sudo systemctl reload nginx
```

---

### üß™ Final Result

* Visitors receive cached content unless they're logged in, posting data, or visiting admin paths.
* Reduces PHP load while maintaining dynamic behavior where needed.
* Integrates seamlessly with **WP Super Cache** plugin‚Äôs directory structure.
