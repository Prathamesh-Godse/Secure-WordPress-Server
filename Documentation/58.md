
# Domain & SSL Validation, HTTPS Enforcement, and Auto-Renewal

## Purpose

To verify the domain’s HTTP/HTTPS behavior, SSL certificate validity, protocol support (HTTP/2, HTTP/3), and automate certificate renewal with Nginx reload using `cron`. This ensures a consistent, secure, and self-maintaining production environment.

---

## Structured Document

### 1. Check Domain Response Headers

```bash
curl -I http://prathameshgodse.com
curl -I http://www.prathameshgodse.com
curl -I https://www.prathameshgodse.com
curl -I https://prathameshgodse.com
```

#### What it does:

* Sends a `HEAD` request to each variation of your domain.
* Displays response headers without downloading the content.
* Useful for confirming:

  * Redirection rules (HTTP → HTTPS)
  * Status codes (e.g., 301, 200)
  * Protocol (HTTP/1.1, HTTP/2, HTTP/3)
  * SSL usage and redirection paths (`location:` header)

---

### 2. External Tools to Validate SSL & HTTP/3

* [**SSL Labs SSL Test**](https://www.ssllabs.com/ssltest/):
  Comprehensive SSL certificate test—validity, chain trust, cipher strength, grade (A+ recommended).

* [**HTTP/3 Check**](https://http3check.net/):
  Verifies whether HTTP/3 (QUIC) is enabled, reachable, and properly configured.

---

### 3. Confirm HTTP/3 via Browser

**Steps:**

1. Open browser developer tools (usually `F12` or right-click → *Inspect*).
2. Go to the **Network** tab.
3. Right-click the column header and enable `Protocol`.
4. Refresh the page.
5. Check the `Protocol` column — you should see `h3` (for HTTP/3), `h2` (for HTTP/2), or `http/1.1`.

---

### 4. Force HTTPS in WordPress

**In WordPress Admin Panel:**

1. Navigate to `Settings > General`.
2. Update both fields:

   * **WordPress Address (URL)** → `https://example.com`
   * **Site Address (URL)** → `https://example.com`
3. Save Changes.

This ensures all URLs generated by WordPress use the HTTPS scheme.

---

### 5. Verify Installed Certificates

```bash
sudo certbot certificates
```

Displays all active certificates, domains covered, and their expiration dates. Useful for audit and troubleshooting.

---

### 6. Automate SSL Renewal with Crontab

#### Edit Crontab

```bash
sudo crontab -e
```

#### Add the following entries:

```cron
# Renew certs twice a month
00 1 14,28 * * certbot renew --force-renewal >/dev/null 2>&1

# Reload Nginx to apply renewed certs
00 2 14,28 * * systemctl reload nginx >/dev/null 2>&1
```

#### Verify the entries:

```bash
sudo crontab -l
```

---

## Best Practices

* Schedule certificate renewal at off-peak hours.
* Always reload (or gracefully restart) Nginx after certificate renewal to ensure new certs are in use.
* Suppress output with `>/dev/null 2>&1` to avoid filling system logs unless actively debugging.
* Run a manual test of `certbot renew --dry-run` to validate that auto-renewal will succeed.

---

## Crontab Reference

### Format:

```
m  h  dom  mon  dow   command
```

| Field | Description         | Example Values    |
| ----- | ------------------- | ----------------- |
| `m`   | Minute (0–59)       | `00`              |
| `h`   | Hour (0–23)         | `1`, `2`          |
| `dom` | Day of month (1–31) | `14,28`           |
| `mon` | Month (1–12)        | `*` (every month) |
| `dow` | Day of week (0–7)   | `*` (any day)     |
| `cmd` | Command to run      | certbot/systemctl |

---

### Cron Job Summary

| Time      | Action                          | Purpose                                  |
| --------- | ------------------------------- | ---------------------------------------- |
| 1:00 AM   | `certbot renew --force-renewal` | Force certificate renewal (twice/month)  |
| 2:00 AM   | `systemctl reload nginx`        | Reloads Nginx to apply renewed certs     |
| Frequency | 14th and 28th of every month    | Scheduled for mid- and end-of-month runs |
